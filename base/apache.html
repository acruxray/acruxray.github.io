<h1 class="center-align">Работа с Apache</h1>
<h2 class="center-align">Установка LAMP-сервера (Apache, MySQL, PHP)</h2>

<pre class="card-panel"><code class="language-bash"><xmp>sudo tasksel install lamp-server
</xmp></code></pre>

<h2 class="center-align">Установка (Apache, MySQL, PHP) по отдельности</h2>

<pre class="card-panel"><code class="language-bash"><xmp>sudo apt-get install apache2 
sudo apt-get install php5 libapache2-mod-php5 
sudo apt-get install mysql-server 
sudo apt-get install php5-curl
</xmp></code></pre>

<h2 class="center-align">Если необходим PHP7</h2>

<pre class="card-panel"><code class="language-bash"><xmp>sudo apt-get install php7.0-mysql php7.0-curl php7.0-json php7.0-cgi  php7.0 libapache2-mod-php7.0
</xmp></code></pre>

<h2 class="center-align">Возможность вывода ошибок</h2>

<pre class="card-panel"><code class="language-bash"><xmp># в файле /etc/php/7.0/apache2/php.ini необходимо поменять значение
display_errors = Off
# на
display_errors = On
</xmp></code></pre>

<h2 class="center-align">Перезапуск Apache</h2>

<pre class="card-panel"><code class="language-bash"><xmp>sudo /etc/init.d/apache2 restart
</xmp></code></pre>

<h2 class="center-align">Присвоение прав пользователя папке сервера для разработки</h2>

<pre class="card-panel"><code class="language-bash"><xmp>sudo chown -R $USER:$USER /var/www
</xmp></code></pre>

<h2 class="center-align">Выставление прав доступа к папкам и файлам</h2>

<pre class="card-panel"><code class="language-bash"><xmp>sudo chmod -R 777 /var/www/test
</xmp></code></pre>

<h2 class="center-align">Выставление прав доступа пользователю к папкам и файлам</h2>

<pre class="card-panel"><code class="language-bash"><xmp>sudo chown nazar /var/www/test
</xmp></code></pre>

<h2 class="center-align">Активация серверных дирректив .htaccess</h2>

<pre class="card-panel"><code class="language-bash"><xmp># Редактируем /etc/apache2/sites-enabled/000-default
# Ищем строку AllowOverride None в <Directory /var/www/> и заменяем её на AllowOverride All и перезапускаем Апач:

<VirtualHost *:80>
	ServerAdmin webmaster@localhost

	DocumentRoot /var/www
	<Directory />
		Options FollowSymLinks
		AllowOverride None
	</Directory>
	<Directory /var/www/>
		Options Indexes FollowSymLinks MultiViews
		AllowOverride All
		Order allow,deny
		allow from all
	</Directory>

	ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
	<Directory "/usr/lib/cgi-bin">
		AllowOverride None
		Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
		Order allow,deny
		Allow from all
	</Directory>

	ErrorLog ${APACHE_LOG_DIR}/error.log

	# Possible values include: debug, info, notice, warn, error, crit,
	# alert, emerg.
	LogLevel warn

	CustomLog ${APACHE_LOG_DIR}/access.log combined

    Alias /doc/ "/usr/share/doc/"
    <Directory "/usr/share/doc/">
        Options Indexes MultiViews FollowSymLinks
        AllowOverride None
        Order deny,allow
        Deny from all
        Allow from 127.0.0.0/255.0.0.0 ::1/128
    </Directory>

</VirtualHost>
</xmp></code></pre>

<h2 class="center-align">Запуск RewriteEngine (для возможности использовать mod_rewrite)</h2>

<pre class="card-panel"><code class="language-bash"><xmp>sudo ln -s /etc/apache2/mods-available/rewrite.load /etc/apache2/mods-enabled/
sudo /etc/init.d/apache2 restart
</xmp></code></pre>

<h2 class="center-align">Активация CGI</h2>

<pre class="card-panel"><code class="language-bash"><xmp># Редактируем /etc/apache2/sites-enabled/000-default
# Ищем строки ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/, <Directory "/usr/lib/cgi-bin"> и заменяем /usr/lib/cgi-bin на /var/www/cgi-bin:

<VirtualHost *:80>
	ServerAdmin webmaster@localhost

	DocumentRoot /var/www
	<Directory />
		Options FollowSymLinks
		AllowOverride None
	</Directory>
	<Directory /var/www/>
		Options Indexes FollowSymLinks MultiViews
		AllowOverride All
		Order allow,deny
		allow from all
	</Directory>

	ScriptAlias /cgi-bin/ /var/www/cgi-bin
	<Directory "/var/www/cgi-bin">
		AllowOverride None
		Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
		Order allow,deny
		Allow from all
	</Directory>

	ErrorLog ${APACHE_LOG_DIR}/error.log

	# Possible values include: debug, info, notice, warn, error, crit,
	# alert, emerg.
	LogLevel warn

	CustomLog ${APACHE_LOG_DIR}/access.log combined

    Alias /doc/ "/usr/share/doc/"
    <Directory "/usr/share/doc/">
        Options Indexes MultiViews FollowSymLinks
        AllowOverride None
        Order deny,allow
        Deny from all
        Allow from 127.0.0.0/255.0.0.0 ::1/128
    </Directory>

</VirtualHost>
</xmp></code></pre>

<h3 class="center-align">Затем задаём права для папки и перезапускаем Апач:</h3>

<pre class="card-panel"><code class="language-bash"><xmp>sudo chmod -R 755 /var/www/cgi-bin
sudo /etc/init.d/apache2 restart
</xmp></code></pre>

<h2 class="center-align">Подключение модуля CGI</h2>

<pre class="card-panel"><code class="language-bash"><xmp># В новых версиях Apache необходимо
sudo a2enmod cgi
sudo /etc/init.d/apache2 restart
</xmp></code></pre>

<h2 class="center-align">Изменение пользователя, от имени которого запускается Apache</h2>

<pre class="card-panel"><code class="language-bash"><xmp># Для изменения имени пользователя и группы, от имени которых запускается и работает apache,
# редактируем переменные в файле /etc/apache2/envvars:

export APACHE_RUN_USER=www-data
export APACHE_RUN_GROUP=www-data

# Затем перезапускаем Апач
</xmp></code></pre>

<h2 class="center-align">Модуль для работы с JSON (если PHP версии 5.5)</h2>

<pre class="card-panel"><code class="language-bash"><xmp>sudo apt-get install php5-json
sudo service php5-fpm restart
</xmp></code></pre>